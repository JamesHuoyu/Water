units real
atom_style full 
boundary p p p

read_data 1H2O
replicate 8 8 8

pair_style lj/cut/tip4p/long 1 2 1 1 0.1546 12
kspace_style pppm/tip4p 1.0e-6

bond_style harmonic
angle_style harmonic

pair_coeff 1 1 0.18521 3.1589 #O-O
pair_coeff 1 2 0.0 0.0 #O-H
pair_coeff 2 2 0.0 1.0 #H-H
pair_modify tail yes

bond_coeff 1 1000.0 0.9572 #O-H
angle_coeff 1 100.0 104.52 #H-O-H

group gH2O type 1 2

neighbor 3.0 bin
neigh_modify delay 0 every 1 check yes

minimize 1.0e-4 1.0e-6 1000 10000
reset_timestep 0

velocity all create 298.15 12345 dist gaussian
fix 1 gH2O shake 1.0e-4 100 0 b 1 a 1

variable massAll equal mass(all)/6.022e23
variable volCm3 equal vol*1.0e-24
variable density_sys equal v_massAll/v_volCm3

thermo 100
thermo_style    custom step temp vol etotal pe ke epair ecoul lx ly lz v_density_sys cpuremain
thermo_modify   flush yes

fix fnpt all npt temp 298.15 298.15 100.0 iso 0.9869 0.9869 500.0

timestep 1.0
run 20000

compute rdf1 gH2O rdf 100 1 1 1 2 2 2
fix 2 gH2O ave/time 1000 1 1000 c_rdf1[*] file tmp.rdf1 mode vector

run 1000

write_data 16by16by16_H20.data pair ij