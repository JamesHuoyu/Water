units real
atom_style full 
boundary p p p

pair_style lj/cut/tip4p/long 1 2 1 1 0.1546 9.5
kspace_style pppm/tip4p 1.0e-5

bond_style harmonic
angle_style harmonic

read_data ../rdf/8by8by8_H20.data

pair_coeff 1 1 0.18521 3.1589 #O-O
pair_coeff 1 2 0.0 0.0 #O-H
pair_coeff 2 2 0.0 1.0 #H-H
pair_modify tail yes

bond_coeff 1 1000.0 0.9572 #O-H
angle_coeff 1 100.0 104.52 #H-O-H

group gH2O type 1 2
group gO type 1

neighbor 3.0 bin
neigh_modify delay 10 every 2 check yes

reset_timestep 0
shell "mkdir -p rst"

variable massAll equal mass(all)/6.022e23
variable volCm3 equal vol*1.0e-24
variable density_sys equal v_massAll/v_volCm3
variable tmp equal temp

compute rdf1 gO rdf 100 1 1

timestep 2.0

thermo 1000
thermo_style custom step temp vol etotal pe lx v_density_sys
thermo_modify flush yes

fix 1 gH2O shake 1.0e-4 100 0 b 1 a 1
fix fnpt all npt temp 298.15 298.15 1000.0 iso 0.9869 0.9869 5000.0
# fix fdensity gH2O ave/time 250 80 20000 v_density_sys file tmp.rho # 间隔0.5ps采样，总时间为40ps
# fix ftemp all ave/time 250 80 20000 v_tmp file tmp.temp 
# fix frdf gO ave/time 250 80 20000 c_rdf1[*] file tmp.rdf1 mode vector

# dump dO gO custom 5000 dump_O.lammpstrj id xu yu zu # 间隔10ps采样
# dump_modify dO sort id

restart 5000000 rst/200K_1atm  # every 5,000,000 steps (~10 ns with dt=2 fs)
run 30000000 # 60ns

