units real
atom_style full 
boundary p p p

pair_style lj/cut/tip4p/long 1 2 1 1 0.1546 12
kspace_style pppm/tip4p 1.0e-6

bond_style harmonic
angle_style harmonic

read_data 250MPa.data

pair_coeff 1 1 0.18521 3.1589 #O-O
pair_coeff 1 2 0.0 0.0 #O-H
pair_coeff 2 2 0.0 1.0 #H-H
pair_modify tail yes

bond_coeff 1 1000.0 0.9572 #O-H
angle_coeff 1 100.0 104.52 #H-O-H

group gH2O type 1 2
group gO type 1

neighbor 3.0 bin
neigh_modify delay 0 every 1 check yes

reset_timestep 0
fix 1 gH2O shake 1.0e-4 100 0 b 1 a 1
timestep 1.0 # 1fs

compute rdf1 gH2O rdf 100 1 1 1 2 2 2
variable massAll equal mass(all)/6.022e23
variable volCm3 equal vol*1.0e-24
variable density_sys equal v_massAll/v_volCm3


thermo_style custom step temp vol etotal pe ke epair ecoul lx ly lz v_density_sys
thermo 1000
fix fnpt all npt temp 225.0 225.0 1000.0 iso 2467.3082 2467.3082 5000.0


dump dO gO custom 100 dump_O_250MPa.lammpstrj id xu yu zu # 0.1ps
dump_modify dO sort id

# fix 2 gH2O ave/time 1000 1 1000 c_rdf1[*] file tmp.rdf1 mode vector

run 250000 # 250ps