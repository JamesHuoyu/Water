units real
atom_style full
boundary p p p

package intel 1 omp 2

read_data 1H2O
replicate 10 10 10

pair_style lj/cut/tip4p/long 1 2 1 1 0.1546 9.5
kspace_style pppm/tip4p 1.0e-5

bond_style zero
angle_style zero

pair_coeff 1 1 0.18521 3.1589 #O-O
pair_coeff 1 2 0.0 0.0 #O-H
pair_coeff 2 2 0.0 1.0 #H-H
pair_modify tail yes

bond_coeff 1 0.9572 #O-H
angle_coeff 1 104.52 #H-O-H


group gH2O type 1 2
group gO type 1

# neighbor 3.0 bin
# neigh_modify delay 0 every 1 check yes

timestep 2.0
variable massAll equal mass(all)/6.022e23
variable volCm3 equal vol*1.0e-24
variable density_sys equal v_massAll/v_volCm3
variable tmp equal temp

# variable omp_threads equal omp_get_num_threads()
thermo_style custom step cpu
thermo 1000
thermo_modify flush yes

velocity all create 290.0 12345 dist gaussian
fix rigid gH2O shake 1.0e-4 100 0 b 1 a 1
fix fnpt all npt temp 290.0 290.0 100.0 iso 0.9869 0.9869 1000.0
run 1000 # 20ps